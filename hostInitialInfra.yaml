trigger:
# - main
# - none

variables:
  azureSubscription: 'dicePipeline'
  containerRegistry: 'dockerSC'
  acrName: 'thisacr'
  imageName: 'dicedatascraping'
  imageTag: 'latest'
  imageRepository: '$(acrName).azurecr.io/$(imageName)'
  artifactName: '$(imageName)_ARTIFACT'
  dockerfilePath: '$(Build.SourcesDirectory)/repo/Dockerfile'
  gitRepoUrl: 'https://github.com/UttU28/Dice-JobScraping.git'
  gitBranch: 'main'


jobs:
- job: Checkout
  displayName: 'Checkout Code INITIAL INFRA'
  pool:
    vmImage: 'ubuntu-latest'
  steps:
    - checkout: self

- job: Terraform
  displayName: 'Deploy Terraform Infrastructure'
  # dependsOn: BuildAndDeploy
  pool:
    vmImage: 'ubuntu-latest'
  steps:
  - template: terraformTasks.yaml
    parameters:
      workingDirectory: 'initialInfra'

